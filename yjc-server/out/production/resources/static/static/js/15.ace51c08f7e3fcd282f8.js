webpackJsonp([15],{FBMH:function(t,i,s){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var e=s("Dd8w"),o=s.n(e),c=s("d2gY"),a=s("1xBK"),l=s("VsUZ"),n=s("NYxO"),r=s("Au9i"),h={name:"ShoppingCart",data:function(){return{startX:0,endX:0,checkBoxModel:[],allp:!1,confirmInfo:{},list:[],totalPrice:0,orderConfirmList:[],staticUrl:c.config.static_url,hospitalList:this.common.getStorage("hospitalList"),pShow:!1}},methods:o()({skip:function(t){this.checkSlide()?this.restSlide():this.$router.push({name:"ProjectDetail",params:{uuid:t.uuid,type:t.type}})},cancel:function(){this.restSlide()},deleteProject:function(t){var i=this,s={uuid:t};l.a.deleteFromCart(s).then(function(s){var e=i;if(200===s.data.code){for(var o in e.getShoppingCartTotal(),e.list)if(t===e.list[o].uuid){if(e.list.splice(o,1),e.computedTotalPrice(),e.list.length){for(var c in e.checkBoxModel)if(Number(t)===Number(e.checkBoxModel[c]))return console.log(e.checkBoxModel),e.checkBoxModel.splice(c,1),void console.log(e.checkBoxModel)}else e.pShow=!0,e.checkBoxModel=[];return}}else Object(r.Toast)({message:"删除失败，请稍后重试",position:"bottom",duration:2e3})}).catch(function(t){console.log(t)})},touchStart:function(t){this.startX=t.touches[0].clientX},touchEnd:function(t){var i=t.currentTarget.parentElement;this.endX=t.changedTouches[0].clientX,"0"===i.dataset.type&&this.startX-this.endX>50&&(this.restSlide(),i.dataset.type=1),"1"===i.dataset.type&&this.startX-this.endX<-50&&(this.restSlide(),i.dataset.type=0),this.startX=0,this.endX=0},checkSlide:function(){for(var t=document.querySelectorAll(".item_wrapper"),i=0;i<t.length;i++)if("1"===t[i].dataset.type)return!0;return!1},restSlide:function(){for(var t=document.querySelectorAll(".item_wrapper"),i=0;i<t.length;i++)t[i].dataset.type=0},checkOne:function(t){this.list[t].isBuy?this.list[t].isBuy=!1:this.list[t].isBuy=!0,this.computedTotalPrice()},checkPick:function(){for(var t in this.checkBoxModel=[],this.list)this.list[t].isBuy&&this.checkBoxModel.push(this.list[t].id);this.checkBoxModel.length===this.list.length?this.allp=!0:this.allp=!1},checkAll:function(){var t=this;t.allp?(t.checkBoxModel=[],t.allp=!1):(t.checkBoxModel=[],t.list.forEach(function(i){t.checkBoxModel.push(i.id)}),t.allp=!0)},checkModel:function(){var t=[];if(this.checkBoxModel.length){for(var i in t=this.checkBoxModel.concat())for(var s in this.list)if(t[i]===this.list[s].id){this.list[s].isBuy=!0;break}}else{t=this.checkBoxModel.concat();for(var e=0;e<this.list.length;e++)this.list[e].isBuy=!1}this.checkedList=[],this.checkedList=this.list.concat(),this.computedTotalPrice()},goHandleClick:function(){if(this.checkBoxModel.length){if(this.checkBoxModel.length>1)for(var t=0;t<this.list.length;t++)for(var i=1;i<this.list.length;i++)if(this.list[t].hospital!==this.list[i].hospital)return void this.common.toast("只能选择同一家医院的项目进行结算");for(var s in this.orderConfirmList=[],this.list)!0===this.list[s].isBuy&&this.orderConfirmList.push(this.list[s]);var e={totalPrice:this.totalPrice,orderConfirmList:this.orderConfirmList,projectNumber:this.checkBoxModel.length};this.common.setStorage("orderConfirmInfo",e),this.$router.push({path:"/orderconfirm"})}else this.common.toast("请选择项目")},getShoppingCartList:function(){var t=this;l.a.shoppingCart({pageNo:1,pageSize:1e4}).then(function(i){200===i.data.code?t.handleShoppingCartList(i.data.successObject.projectList):t.common.toast(i.data.msg)}).catch(function(i){t.common.toast(i)})},handleShoppingCartList:function(t){for(var i in t.length||(this.pShow=!0),t)for(var s in this.hospitalList)if(t[i].hospital===this.hospitalList[s].uuid){t[i].hospitalName=this.hospitalList[s].name,t[i].hospitalLogo=this.hospitalList[s].logo;break}for(var e in t)t[e].isBuy=!1;this.list=[],this.list=this.list.concat(t),console.log(this.list)},computedTotalPrice:function(){for(var t in this.totalPrice=0,this.list)if(this.list[t].isBuy){var i=this.list[t];this.totalPrice+=i.nowPrice}}},Object(n.b)(["getShoppingCartTotal"])),created:function(){this.getShoppingCartList(),a.a.init()}},d={render:function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"shopping"},[t.pShow?e("div",{staticClass:"no_message"},[e("img",{attrs:{src:s("cYJE")}}),t._v(" "),e("p",[t._v("您的购物车暂时还是空的哦~")]),t._v(" "),e("router-link",{staticClass:"go_btn",attrs:{tag:"div",to:"/home"}},[t._v("去逛逛")])],1):e("div",{staticClass:"shopping_cart_wrapper"},[e("div",{staticClass:"shopping_list"},t._l(t.list,function(i,s){return e("div",{key:i.id,staticClass:"item_wrapper",attrs:{"data-type":"0"}},[e("div",{staticClass:"item",on:{"!touchstart":function(i){return t.touchStart(i)},"!touchend":function(i){return t.touchEnd(i)},click:function(s){t.skip(i)}}},[e("span",{key:i.id,staticClass:"select",class:i.isBuy?"selected":"",on:{click:function(i){i.stopPropagation(),t.checkOne(s),t.checkPick()}}}),t._v(" "),e("img",{directives:[{name:"lazy",rawName:"v-lazy",value:t.staticUrl+i.logo,expression:"staticUrl + item.logo"}],staticClass:"label_img",attrs:{alt:""}}),t._v(" "),e("div",{staticClass:"des"},[e("div",[e("span",{staticClass:"p_name"},[t._v(t._s(i.name))]),t._v(" "),e("p",[e("span",{staticClass:"cycle_label"},[t._v("周期：")]),t._v(" "),e("span",{staticClass:"cycle"},[t._v(t._s(i.period))])])]),t._v(" "),e("div",[e("span",{staticClass:"h_name"},[t._v(t._s(i.hospitalName))]),t._v(" "),e("p",[e("span",{staticClass:"price"},[t._v("¥"+t._s(i.nowPrice))])])])])]),t._v(" "),e("div",{ref:"btn_box",refInFor:!0,staticClass:"btn_box"},[e("div",{staticClass:"cancel_btn btn",on:{click:t.cancel}},[t._v("取消")]),t._v(" "),e("div",{staticClass:"delete_btn btn",on:{click:function(s){t.deleteProject(i.uuid)}}},[t._v("删除")])])])}),0),t._v(" "),e("div",{staticClass:"shopping_count"},[e("div",{staticClass:"select_box"},[e("span",{staticClass:"select",class:t.allp?"selected":"",on:{click:function(i){t.checkAll(),t.checkModel()}}}),t._v(" "),e("span",[t._v("全选")])]),t._v(" "),e("div",{staticClass:"count_box"},[e("span",{staticClass:"count_label"},[t._v("合计：")]),t._v(" "),e("span",{staticClass:"count_price"},[t._v("¥"+t._s(t.totalPrice))])]),t._v(" "),e("div",{staticClass:"checkout_btn",class:t.checkBoxModel.length>0?"checked":"",on:{click:t.goHandleClick}},[t._v("去结算("+t._s(t.checkBoxModel.length)+")")])])])])},staticRenderFns:[]};var p=s("VU/8")(h,d,!1,function(t){s("pOYK")},"data-v-ffeb85b6",null);i.default=p.exports},cYJE:function(t,i,s){t.exports=s.p+"static/img/no_project.1b7ffa7.png"},pOYK:function(t,i){}});