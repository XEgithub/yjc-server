webpackJsonp([13],{BO1k:function(t,n,e){t.exports={default:e("fxRn"),__esModule:!0}},Hvtk:function(t,n){},WZYS:function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var s=e("mvHQ"),i=e.n(s),o=e("BO1k"),c=e.n(o),a=e("Dd8w"),r=e.n(a),m=e("VsUZ"),l=e("NYxO"),u=e("d2gY"),d={name:"comment",data:function(){return{upload_url:"http://cn.ynhdkc.com/admin/uploadapiv2/uploadpics",projectList:[],contentList:[],imgs:[],orderInfo:this.common.getStorage("orderInfo"),content:[],grade:"5",currentIndex:-1,flag:!1}},computed:r()({},Object(l.d)({imgStatus:function(t){return t.imgstore.img_status},imgPaths:function(t){return t.imgstore.img_paths}})),watch:{imgStatus:function(){"finished"===this.imgStatus&&this.submit()}},methods:{enter:function(t){this.flag||(this.currentIndex=t)},leave:function(){this.flag||(this.currentIndex=-1)},Selected:function(t){this.flag=!0,this.currentIndex=t},upload:function(){if(-1!==this.currentIndex){for(var t in this.content=[],this.contentList)this.contentList[t].ischecked&&this.content.push(this.contentList[t].content);this.content.length?"selected"===this.imgStatus?this.$store.commit("set_img_status","uploading"):this.submitComment():this.common.toast("请进行评论留言")}else this.common.toast("请对服务质量进行评分")},submit:function(){var t=[],n=!0,e=!1,s=void 0;try{for(var i,o=c()(this.imgPaths);!(n=(i=o.next()).done);n=!0){var a=i.value;t.push(a)}}catch(t){e=!0,s=t}finally{try{!n&&o.return&&o.return()}finally{if(e)throw s}}this.imgs=t,this.submitComment()},selectContent:function(t){for(var n in this.ischecked=!t.ischecked,this.contentList)t.id===this.contentList[n].id&&(this.contentList[n].ischecked=!this.contentList[n].ischecked)},getCommentContent:function(){var t=this;m.a.commentContent().then(function(n){if(200===n.data.code){var e=n.data.successObject.records;for(var s in e)e[s].ischecked=!1;t.contentList=t.contentList.concat(e)}else t.common.toast(n.data.msg)}).catch(function(n){t.common.toast(n)})},submitComment:function(){var t=this,n="";this.imgs.length&&(n=this.imgs.join());var e={content:this.content.join(),orderList:this.orderInfo.orderId,image:n,grade:this.currentIndex};m.a.submitComment(i()(e)).then(function(n){200===n.data.code?(t.common.toast("评论成功"),t.$router.push({path:"/mycomment"})):t.common.toast(n.data.msg)}).catch(function(n){t.common.toast(n)})}},created:function(){this.getCommentContent(),console.log(u.config.upload_url)},destoryed:function(){this.imgs=[]}},h={render:function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",{staticClass:"comment"},[e("div",{staticClass:"content_common order_info"},[e("div",{staticClass:"order_num common_item"},[e("label",[t._v("订单号：")]),t._v(" "),e("p",[t._v(t._s(t.orderInfo.orderNumber))])]),t._v(" "),e("div",{staticClass:"visite_items common_item"},[e("label",[t._v("就诊项目：")]),t._v(" "),e("p",{staticClass:"visite_list"},t._l(t.orderInfo.projectList,function(n){return e("span",{key:n.name,staticClass:"project"},[t._v(t._s(n.name))])}),0)]),t._v(" "),e("div",{staticClass:"common_item"},[e("label",[t._v("就医人：")]),t._v(" "),e("p",[t._v(t._s(t.orderInfo.patient))])]),t._v(" "),t._m(0)]),t._v(" "),e("div",{staticClass:"content_common"},[e("div",{staticClass:"common_item"},[e("label",{staticClass:"comment_lable"},[t._v("服务质量")]),t._v(" "),e("p",{staticClass:"star_box"},t._l(5,function(n){return e("span",{key:n,class:{on:t.currentIndex>=n},on:{mouseenter:function(e){t.enter(n)},mouseleave:function(n){t.leave()},click:function(e){t.Selected(n)}}})}),0)]),t._v(" "),e("div",{staticClass:"visite_items common_item"},[e("label",{staticClass:"comment_lable"},[t._v("评论留言")]),t._v(" "),e("p",{staticClass:"visite_list"},t._l(t.contentList,function(n){return e("span",{key:n.uuid,staticClass:"comment_des",class:n.ischecked?"active":"",on:{click:function(e){t.selectContent(n)}}},[t._v(t._s(n.content))])}),0)]),t._v(" "),e("div",{staticClass:"common_item upload_wrapper"},[e("label",{staticClass:"comment_lable"},[t._v("评论图片")]),t._v(" "),e("uploader",{attrs:{url:"http://192.168.31.236:80/rest/img/upload/comment"}})],1)]),t._v(" "),e("div",{staticClass:"button_wrapper"},[e("div",{staticClass:"comment_btn",on:{click:t.upload}},[t._v("提交")])])])},staticRenderFns:[function(){var t=this.$createElement,n=this._self._c||t;return n("div",{staticClass:"common_item"},[n("label",[this._v("服务护士：")])])}]};var _=e("VU/8")(d,h,!1,function(t){e("Hvtk")},"data-v-4a1d3e0d",null);n.default=_.exports},fxRn:function(t,n,e){e("+tPU"),e("zQR9"),t.exports=e("g8Ux")},g8Ux:function(t,n,e){var s=e("77Pl"),i=e("3fs2");t.exports=e("FeBl").getIterator=function(t){var n=i(t);if("function"!=typeof n)throw TypeError(t+" is not iterable!");return s(n.call(t))}}});