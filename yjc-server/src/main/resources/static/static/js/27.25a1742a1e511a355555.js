webpackJsonp([27],{ZWWU:function(e,t){},jKca:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s("RfcX"),i=s("VsUZ"),o={name:"message",props:[],components:{HeaderCom:a.a},data:function(){return{messageList:[],currentIndex:"-1",pageNo:0,pageSize:10,totalPages:"",Loop:"",noMore:0,pShow:!1}},methods:{back:function(){this.$router.go(-1)},getMessageList:function(){var e=this;this.loading=!0;var t={pageNo:this.pageNo,pageSize:this.pageSize};i.a.messageList(t).then(function(t){200===t.data.code?(1===e.pageNo&&(e.messageList=[]),e.messageList=e.messageList.concat(t.data.successObject.records),e.totalPages=t.data.successObject.pages,e.loading=!1,e.messageList.length||(e.pShow=!0)):e.common.toast(t.data.msg)}).catch(function(t){e.common.toast(t)})},showMessageBtn:function(e){var t=this;clearInterval(t.Loop),t.Loop=setTimeout(function(){t.currentIndex=e},500)},clearLoop:function(){clearInterval(this.Loop)},deleteMessage:function(e){var t=this,s=this,a={uuid:e};i.a.deleteMessage(a).then(function(a){if(200===a.data.code){for(var i in s.messageList)if(e===s.messageList[i].uuid)return s.messageList.splice(i,1),s.currentIndex="-1",s.messageList.length||(s.pShow=!0),void s.common.toast("删除成功")}else t.common.toast(a.data.msg)}).catch(function(e){t.common.toast(e)})},loadMore:function(){this.loading=!0,this.pageNo++,1===this.pageNo?this.getMessageList():this.pageNo>1&&this.totalPages>=this.pageNo?this.getMessageList():this.noMore=1},skipToMessageInfo:function(e){this.currentIndex=-1}},created:function(){this.loadMore()}},n={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"message"},[a("HeaderCom",{attrs:{title:"消息通知"},on:{backPage:e.back}}),e._v(" "),e.pShow?a("div",{staticClass:"no_message"},[a("img",{attrs:{src:s("AL6J")}}),e._v(" "),a("p",[e._v("您暂时还没有新消息通知哦~")])]):a("div",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:e.loadMore,expression:"loadMore"}],staticClass:"messageList",attrs:{"infinite-scroll-disabled":"loading","infinite-scroll-distance":"10"}},[a("div",{staticClass:"list_wrapper"},e._l(e.messageList,function(t,s){return a("div",{key:t.id,staticClass:"item_wrapper"},[a("div",{staticClass:"item",on:{"!touchstart":function(t){e.showMessageBtn(s)},"!touchend":function(a){e.clearLoop(s,t.uuid)},click:function(t){e.skipToMessageInfo()}}},[a("h5",[e._v(e._s(t.title))]),e._v(" "),a("p",[e._v(e._s(t.content))]),e._v(" "),"1"===t.markRead?a("span"):e._e()]),e._v(" "),s===e.currentIndex?a("div",{staticClass:"item_del",on:{click:function(s){e.deleteMessage(t.uuid)}}},[e._v("删除")]):e._e()])}),0)]),e._v(" "),e.noMore?a("p",{staticClass:"noMore"},[e._v("没有更多数据了~")]):e._e()],1)},staticRenderFns:[]};var c=s("VU/8")(o,n,!1,function(e){s("ZWWU")},"data-v-d6488d48",null);t.default=c.exports}});